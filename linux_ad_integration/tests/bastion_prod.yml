---
- hosts: "tag_Name_ehe_production_{{ hostname }}"
  become: True
  become_user: root
  gather_facts: yes
  vars:
    ansible_user: ubuntu
    hostname: "bastion_temp"
    access_groups:
      - vpn-prd
    sudo_group: vpn-prd
    # LDAP Servers in order of precedence
    ldap_server:
      - host: "mgmtdc01"
        domain: "{{ ldap_domain }}"
        server_ip: "10.100.0.200"
      - host: "mgmtdc02"
        domain: "{{ ldap_domain }}"
        server_ip: "10.100.16.200"
    # Domain Controllers in order of precedence
    pdc:
      - host: "mgmtdc01"
        domain: "{{ ldap_domain }}"
        server_ip: "10.100.0.200"
      - host: "mgmtdc02"
        domain: "{{ ldap_domain }}"
        server_ip: "10.100.16.200"
vars_prompt:
    - name: admin_password
      prompt: "Please enter the password for {{ admin_user }}@{{ ldap_domain|upper }}"
      private: yes
  pre_tasks:
    - name: Install min python if needed
      raw: test -e /usr/bin/python || (apt -y update && apt install -y python-minimal)
      changed_when: false
    - name: "Display all variables/facts known for {{ hostname }}"
      debug:
        var: hostvars[inventory_hostname]
        verbosity: 0
  roles:
    - { role: "{{ playbook_dir }}/.." }
